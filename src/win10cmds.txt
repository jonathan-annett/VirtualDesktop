if (groups[2].Value == "")
{ // parameter without value
    string upperToken = groups[1].Value.ToUpper();
    switch (upperToken)
    {
        case "HELP": // help screen
        case "H":
        case "?":
            HelpScreen();
            return 0;

        case "QUIET": // don't display messages
        case "Q":
            verbose = false;
            break;

        case "VERBOSE": // display messages
        case "V":
            Console.WriteLine("Verbose mode enabled");
            verbose = true;
            break;

        case "BREAK": // break on error
        case "B":
            if (verbose)
                Console.WriteLine("Break on error enabled");
            breakonerror = true;
            break;

        case "CONTINUE": // continue on error
        case "CO":
            if (verbose)
                Console.WriteLine("Break on error disabled");
            breakonerror = false;
            break;

        case "WRAP": // wrap desktops using "LEFT" or "RIGHT"
        case "W":
            if (verbose)
                Console.WriteLine("Wrapping desktops enabled");
            wrapdesktops = true;
            break;

        case "NOWRAP": // do not wrap desktops
        case "NW":
            if (verbose)
                Console.WriteLine("Wrapping desktop disabled");
            wrapdesktops = false;
            break;

        case "COUNT": // get count of desktops
        case "C":
            rc = VirtualDesktop.Desktop.Count;
            if (verbose)
                Console.WriteLine("Count of desktops: " + rc);
            break;

        case "LIST": // show list of desktops
        case "LI":
            int desktopCount = VirtualDesktop.Desktop.Count;
            int visibleDesktop = VirtualDesktop.Desktop.FromDesktop(
                VirtualDesktop.Desktop.Current
            );
            if (verbose)
            {
                Console.WriteLine("Virtual desktops:");
                Console.WriteLine("-----------------");
            }
            for (int i = 0; i < desktopCount; i++)
            {
                if (i != visibleDesktop)
                    Console.WriteLine(
                        VirtualDesktop.Desktop.DesktopNameFromIndex(i)
                    );
                else
                    Console.WriteLine(
                        VirtualDesktop.Desktop.DesktopNameFromIndex(i)
                            + " (visible)"
                    );
            }
            if (verbose)
                Console.WriteLine("\nCount of desktops: " + desktopCount);
            break;
        case "JSON":
            JSONListing();
            break;

        case "INTERACTIVE":
        case "INT":
            InteractiveMode();
            break;

        case "GETCURRENTDESKTOP": // get number of current desktop and display desktop name
        case "GCD":
            rc = VirtualDesktop.Desktop.FromDesktop(
                VirtualDesktop.Desktop.Current
            );
            if (verbose)
                Console.WriteLine(
                    "Current desktop: '"
                        + VirtualDesktop.Desktop.DesktopNameFromDesktop(
                            VirtualDesktop.Desktop.Current
                        )
                        + "' (desktop number "
                        + rc
                        + ")"
                );
            break;

        case "ISVISIBLE": // is desktop in rc visible?
        case "IV":
            if ((rc >= 0) && (rc < VirtualDesktop.Desktop.Count))
            { // check if parameter is in range of active desktops
                if (VirtualDesktop.Desktop.FromIndex(rc).IsVisible)
                {
                    if (verbose)
                        Console.WriteLine(
                            "Virtual desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    rc
                                )
                                + "' (desktop number "
                                + rc.ToString()
                                + ") is visible"
                        );
                    rc = 0;
                }
                else
                {
                    if (verbose)
                        Console.WriteLine(
                            "Virtual desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    rc
                                )
                                + "' (desktop number "
                                + rc.ToString()
                                + ") is not visible"
                        );
                    rc = 1;
                }
            }
            else
                rc = -1;
            break;

        case "SWITCH": // switch to desktop in rc
        case "S":
            if (
                VirtualDesktop.Desktop.FromDesktop(
                    VirtualDesktop.Desktop.Current
                ) == rc
            )
            {
                if (verbose)
                    Console.Write(
                        "Already on virtual desktop number " + rc.ToString()
                    );
                break;
            }
            if (verbose)
                Console.Write(
                    "Switching to virtual desktop number " + rc.ToString()
                );
            try
            { // activate virtual desktop rc
                VirtualDesktop.Desktop.FromIndex(rc).MakeVisible();
                if (verbose)
                    Console.WriteLine(
                        ", desktop '"
                            + VirtualDesktop.Desktop.DesktopNameFromIndex(rc)
                            + "' is active now"
                    );
            }
            catch
            { // error while activating
                if (verbose)
                    Console.WriteLine();
                rc = -1;
            }
            break;

        case "LEFT": // switch to desktop to the left
        case "L":
            if (verbose)
                Console.Write("Switching to left virtual desktop");
            try
            { // activate virtual desktop to the left
                if (
                    wrapdesktops
                    && (
                        VirtualDesktop.Desktop.FromDesktop(
                            VirtualDesktop.Desktop.Current
                        ) == 0
                    )
                )
                    VirtualDesktop.Desktop
                        .FromIndex(VirtualDesktop.Desktop.Count - 1)
                        .MakeVisible();
                else
                    VirtualDesktop.Desktop.Current.Left.MakeVisible();
                rc = VirtualDesktop.Desktop.FromDesktop(
                    VirtualDesktop.Desktop.Current
                );
                if (verbose)
                    Console.WriteLine(
                        ", desktop number "
                            + rc.ToString()
                            + " ('"
                            + VirtualDesktop.Desktop.DesktopNameFromIndex(rc)
                            + "') is active now"
                    );
            }
            catch
            { // error while activating
                if (verbose)
                    Console.WriteLine();
                rc = -1;
            }
            break;

        case "RIGHT": // switch to desktop to the right
        case "RI":
            if (verbose)
                Console.Write("Switching to right virtual desktop");
            try
            { // activate virtual desktop to the right
                if (
                    wrapdesktops
                    && (
                        VirtualDesktop.Desktop.FromDesktop(
                            VirtualDesktop.Desktop.Current
                        )
                        == VirtualDesktop.Desktop.Count - 1
                    )
                )
                    VirtualDesktop.Desktop.FromIndex(0).MakeVisible();
                else
                    VirtualDesktop.Desktop.Current.Right.MakeVisible();
                rc = VirtualDesktop.Desktop.FromDesktop(
                    VirtualDesktop.Desktop.Current
                );
                if (verbose)
                    Console.WriteLine(
                        ", desktop number "
                            + rc.ToString()
                            + " ('"
                            + VirtualDesktop.Desktop.DesktopNameFromIndex(rc)
                            + "') is active now"
                    );
            }
            catch
            { // error while activating
                if (verbose)
                    Console.WriteLine();
                rc = -1;
            }
            break;

        case "NEW": // create new desktop
        case "N":
            if (verbose)
                Console.Write("Creating virtual desktop");
            try
            { // create virtual desktop, number is stored in rc
                rc = VirtualDesktop.Desktop.FromDesktop(
                    VirtualDesktop.Desktop.Create()
                );
                if (verbose)
                    Console.WriteLine(" number " + rc.ToString());
            }
            catch
            { // error while creating
                Console.WriteLine();
                rc = -1;
            }
            break;

        case "NAME": // removing name of desktop in rc
        case "NA":
            try
            { // remove desktop name
                VirtualDesktop.Desktop.FromIndex(rc).SetName("");
                if (verbose)
                    Console.WriteLine(
                        "Removed name of desktop number " + rc.ToString()
                    );
            }
            catch
            { // error while removing name
                if (verbose)
                    Console.WriteLine("Error removing desktop name");
                rc = -1;
            }
            break;

        case "REMOVE": // remove desktop in rc
        case "R":
            if (verbose)
            {
                Console.Write(
                    "Removing virtual desktop number " + rc.ToString()
                );
                if ((rc >= 0) && (rc < VirtualDesktop.Desktop.Count))
                    Console.WriteLine(
                        " (desktop '"
                            + VirtualDesktop.Desktop.DesktopNameFromIndex(rc)
                            + "')"
                    );
            }
            try
            { // remove virtual desktop rc
                VirtualDesktop.Desktop.FromIndex(rc).Remove();
            }
            catch
            { // error while removing
                Console.WriteLine();
                rc = -1;
            }
            break;

        case "REMOVEALL": // remove all virtual desktops but visible
        case "RA":
            Console.WriteLine("Removing all virtual desktops but visible");
            try
            { // remove all virtual desktops but visible
                VirtualDesktop.Desktop.RemoveAll();
            }
            catch
            { // error while removing
                rc = -1;
            }
            break;

        case "MOVEACTIVEWINDOW": // move active window to desktop in rc
        case "MAW":
            if (verbose)
                Console.WriteLine(
                    "Moving active window to virtual desktop number "
                        + rc.ToString()
                );
            try
            { // move active window
                VirtualDesktop.Desktop.FromIndex(rc).MoveActiveWindow();
                if (verbose)
                    Console.WriteLine(
                        "Active window moved to desktop number "
                            + rc.ToString()
                            + " (desktop '"
                            + VirtualDesktop.Desktop.DesktopNameFromIndex(rc)
                            + "')"
                    );
            }
            catch
            { // error while moving
                if (verbose)
                    Console.WriteLine("No active window or move failed");
                rc = -1;
            }
            break;

        case "LISTWINDOWSONDESKTOP": // list window handles of windows shown on desktop in rc
        case "LWOD":
            if (verbose)
            {
                Console.Write(
                    "Listing handles of windows on virtual desktop number "
                        + rc.ToString()
                );
                if ((rc >= 0) && (rc < VirtualDesktop.Desktop.Count))
                    Console.WriteLine(
                        " (desktop '"
                            + VirtualDesktop.Desktop.DesktopNameFromIndex(rc)
                            + "')"
                    );
            }
            try
            { // list window handles on desktop rc
                ListWindowsOnDesktop(rc);
            }
            catch
            { // error while listing
                Console.WriteLine();
                rc = -1;
            }
            break;

        case "LWCOD":
            try
            { // list window handles on desktop rc
                ListWindowClassesOnDesktop(rc);
            }
            catch
            { // error while listing
                Console.WriteLine();
                rc = -1;
            }
            break;

        case "CLOSEWINDOWSONDESKTOP": // close windows shown on desktop in rc
        case "CWOD":
            if (verbose)
            {
                Console.Write(
                    "Closing windows on virtual desktop number " + rc.ToString()
                );
                if ((rc >= 0) && (rc < VirtualDesktop.Desktop.Count))
                    Console.WriteLine(
                        " (desktop '"
                            + VirtualDesktop.Desktop.DesktopNameFromIndex(rc)
                            + "')"
                    );
            }
            try
            { // close windows on desktop rc
                CloseWindowsOnDesktop(rc);
            }
            catch
            { // error while closing
                Console.WriteLine();
                rc = -1;
            }
            break;

        case "WAITKEY": // wait for keypress
        case "WK":
            if (verbose)
                Console.WriteLine("Press a key");
            Console.ReadKey(true);
            break;

        default:
            rc = -2;
            break;
    }
}
else
{ // parameter with value
    int iParam;

    switch (groups[1].Value.ToUpper())
    {
        case "GETDESKTOP": // get desktop number
        case "GD":
            if (int.TryParse(groups[2].Value, out iParam))
            { // parameter is an integer, use as desktop number
                if ((iParam >= 0) && (iParam < VirtualDesktop.Desktop.Count))
                { // check if parameter is in range of active desktops
                    if (verbose)
                        Console.WriteLine(
                            "Virtual desktop number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "') selected"
                        );
                    rc = iParam;
                }
                else
                    rc = -1;
            }
            else
            { // parameter is a string, search as part of desktop name
                iParam = VirtualDesktop.Desktop.SearchDesktop(groups[2].Value);
                if (iParam >= 0)
                { // desktop found
                    if (verbose)
                        Console.WriteLine(
                            "Virtual desktop number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "') selected"
                        );
                    rc = iParam;
                }
                else
                { // no desktop found
                    if (
                        (groups[2].Value.ToUpper() == "LAST")
                        || (groups[2].Value.ToUpper() == "*LAST*")
                    )
                    { // last desktop
                        iParam = VirtualDesktop.Desktop.Count - 1;
                        if (verbose)
                            Console.WriteLine(
                                "Virtual desktop number "
                                    + iParam.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        iParam
                                    )
                                    + "') selected"
                            );
                        rc = iParam;
                    }
                    else
                    { // no desktop found
                        if (verbose)
                            Console.WriteLine(
                                "Could not find virtual desktop with name containing '"
                                    + groups[2].Value
                                    + "'"
                            );
                        rc = -2;
                    }
                }
            }
            break;

        case "ISVISIBLE": // is desktop visible?
        case "IV":
            if (int.TryParse(groups[2].Value, out iParam))
            { // parameter is an integer, use as desktop number
                if ((iParam >= 0) && (iParam < VirtualDesktop.Desktop.Count))
                { // check if parameter is in range of active desktops
                    if (VirtualDesktop.Desktop.FromIndex(iParam).IsVisible)
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Virtual desktop number "
                                    + iParam.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        iParam
                                    )
                                    + "') is visible"
                            );
                        rc = 0;
                    }
                    else
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Virtual desktop number "
                                    + iParam.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        iParam
                                    )
                                    + "') is not visible"
                            );
                        rc = 1;
                    }
                }
                else
                    rc = -1;
            }
            else
            { // parameter is a string, search as part of desktop name
                iParam = VirtualDesktop.Desktop.SearchDesktop(groups[2].Value);
                if (iParam >= 0)
                { // desktop found
                    if (VirtualDesktop.Desktop.FromIndex(iParam).IsVisible)
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Virtual desktop number "
                                    + iParam.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        iParam
                                    )
                                    + "') is visible"
                            );
                        rc = 0;
                    }
                    else
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Virtual desktop number "
                                    + iParam.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        iParam
                                    )
                                    + "') is not visible"
                            );
                        rc = 1;
                    }
                }
                else
                { // no desktop found
                    if (
                        (groups[2].Value.ToUpper() == "LAST")
                        || (groups[2].Value.ToUpper() == "*LAST*")
                    )
                    { // last desktop
                        iParam = VirtualDesktop.Desktop.Count - 1;
                        if (VirtualDesktop.Desktop.FromIndex(iParam).IsVisible)
                        {
                            if (verbose)
                                Console.WriteLine(
                                    "Virtual desktop number "
                                        + iParam.ToString()
                                        + " (desktop '"
                                        + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                            iParam
                                        )
                                        + "') is visible"
                                );
                            rc = 0;
                        }
                        else
                        {
                            if (verbose)
                                Console.WriteLine(
                                    "Virtual desktop number "
                                        + iParam.ToString()
                                        + " (desktop '"
                                        + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                            iParam
                                        )
                                        + "') is not visible"
                                );
                            rc = 1;
                        }
                    }
                    else
                    { // no desktop found
                        if (verbose)
                            Console.WriteLine(
                                "Could not find virtual desktop with name containing '"
                                    + groups[2].Value
                                    + "'"
                            );
                        rc = -2;
                    }
                }
            }
            break;

        case "NAME": // set name of desktop in rc
        case "NA":
            try
            { // set desktop name
                VirtualDesktop.Desktop.FromIndex(rc).SetName(groups[2].Value);
                if (verbose)
                    Console.WriteLine(
                        "Set name of desktop number "
                            + rc.ToString()
                            + " to '"
                            + VirtualDesktop.Desktop.DesktopNameFromIndex(rc)
                            + "'"
                    );
            }
            catch
            { // error while setting name
                if (verbose)
                    Console.WriteLine(
                        "Error setting desktop name to '"
                            + groups[2].Value
                            + "'"
                    );
                rc = -1;
            }
            break;

        case "SWITCH": // switch to desktop
        case "S":
            if (int.TryParse(groups[2].Value, out iParam))
            { // parameter is an integer, use as desktop number
                if ((iParam >= 0) && (iParam < VirtualDesktop.Desktop.Count))
                { // check if parameter is in range of active desktops
                    rc = iParam;
                    if (
                        VirtualDesktop.Desktop.FromDesktop(
                            VirtualDesktop.Desktop.Current
                        ) == rc
                    )
                    {
                        if (verbose)
                            Console.Write(
                                "Already on virtual desktop number "
                                    + rc.ToString()
                            );
                        break;
                    }
                    if (verbose)
                        Console.WriteLine(
                            "Switching to virtual desktop number "
                                + rc.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "')"
                        );
                    try
                    { // activate virtual desktop iParam
                        VirtualDesktop.Desktop.FromIndex(rc).MakeVisible();
                    }
                    catch
                    { // error while activating
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            { // parameter is a string, search as part of desktop name
                iParam = VirtualDesktop.Desktop.SearchDesktop(groups[2].Value);
                if (iParam >= 0)
                { // desktop found
                    rc = iParam;
                    rc = iParam;
                    if (
                        VirtualDesktop.Desktop.FromDesktop(
                            VirtualDesktop.Desktop.Current
                        ) == rc
                    )
                    {
                        if (verbose)
                            Console.Write(
                                "Already on virtual desktop number "
                                    + rc.ToString()
                            );
                        break;
                    }
                    if (verbose)
                        Console.WriteLine(
                            "Switching to virtual desktop number "
                                + rc.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    rc
                                )
                                + "')"
                        );

                    try
                    { // activate virtual desktop iParam
                        VirtualDesktop.Desktop.FromIndex(rc).MakeVisible();
                    }
                    catch
                    { // error while activating
                        rc = -1;
                    }
                }
                else
                { // no desktop found
                    if (
                        (groups[2].Value.ToUpper() == "LAST")
                        || (groups[2].Value.ToUpper() == "*LAST*")
                    )
                    { // last desktop
                        iParam = VirtualDesktop.Desktop.Count - 1;
                        if (verbose)
                            Console.WriteLine(
                                "Switching to virtual desktop number "
                                    + iParam.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        iParam
                                    )
                                    + "')"
                            );
                        rc = iParam;
                        try
                        { // activate virtual desktop iParam
                            VirtualDesktop.Desktop.FromIndex(iParam).MakeVisible();
                        }
                        catch
                        { // error while activating
                            rc = -1;
                        }
                    }
                    else
                    { // no desktop found
                        if (verbose)
                            Console.WriteLine(
                                "Could not find virtual desktop with name containing '"
                                    + groups[2].Value
                                    + "'"
                            );
                        rc = -2;
                    }
                }
            }
            break;

        case "REMOVE": // remove desktop
        case "R":
            if (int.TryParse(groups[2].Value, out iParam))
            { // parameter is an integer, use as desktop number
                if ((iParam >= 0) && (iParam < VirtualDesktop.Desktop.Count))
                { // check if parameter is in range of active desktops
                    if (verbose)
                        Console.WriteLine(
                            "Removing virtual desktop number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "')"
                        );
                    rc = iParam;
                    try
                    { // remove virtual desktop iParam
                        VirtualDesktop.Desktop.FromIndex(iParam).Remove();
                    }
                    catch
                    { // error while removing
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            { // parameter is a string, search as part of desktop name
                iParam = VirtualDesktop.Desktop.SearchDesktop(groups[2].Value);
                if (iParam >= 0)
                { // desktop found
                    if (verbose)
                        Console.WriteLine(
                            "Removing virtual desktop number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "')"
                        );
                    rc = iParam;
                    try
                    { // remove virtual desktop iParam
                        VirtualDesktop.Desktop.FromIndex(iParam).Remove();
                    }
                    catch
                    { // error while removing
                        rc = -1;
                    }
                }
                else
                { // no desktop found
                    if (
                        (groups[2].Value.ToUpper() == "LAST")
                        || (groups[2].Value.ToUpper() == "*LAST*")
                    )
                    { // last desktop
                        iParam = VirtualDesktop.Desktop.Count - 1;
                        if (verbose)
                            Console.WriteLine(
                                "Removing virtual desktop number "
                                    + iParam.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        iParam
                                    )
                                    + "')"
                            );
                        rc = iParam;
                        try
                        { // remove virtual desktop iParam
                            VirtualDesktop.Desktop.FromIndex(iParam).Remove();
                        }
                        catch
                        { // error while removing
                            rc = -1;
                        }
                    }
                    else
                    { // no desktop found
                        if (verbose)
                            Console.WriteLine(
                                "Could not find virtual desktop with name containing '"
                                    + groups[2].Value
                                    + "'"
                            );
                        rc = -2;
                    }
                }
            }
            break;

        case "SWAPDESKTOP": // swap desktops
        case "SD":
            if (int.TryParse(groups[2].Value, out iParam))
            { // parameter is an integer, use as desktop number
                if (
                    (iParam >= 0)
                    && (iParam < VirtualDesktop.Desktop.Count)
                    && (rc != iParam)
                )
                { // check if parameter is in range of active desktops
                    if (verbose)
                        Console.WriteLine(
                            "Swapping virtual desktops number "
                                + rc.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    rc
                                )
                                + "') and number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "')"
                        );
                    try
                    { // swap virtual desktops rc and iParam
                        SwapDesktops(rc, iParam);
                        rc = iParam;
                    }
                    catch
                    { // error while swapping
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            { // parameter is a string, search as part of desktop name
                iParam = VirtualDesktop.Desktop.SearchDesktop(groups[2].Value);
                if ((iParam >= 0) && (rc != iParam))
                { // desktop found
                    if (verbose)
                        Console.WriteLine(
                            "Swapping virtual desktops number "
                                + rc.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    rc
                                )
                                + "') and number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "')"
                        );
                    try
                    { // swap virtual desktops rc and iParam
                        SwapDesktops(rc, iParam);
                        rc = iParam;
                    }
                    catch
                    { // error while swapping
                        rc = -1;
                    }
                }
                else
                { // no desktop found or source and target the same
                    if (rc == iParam)
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Cannot swap virtual desktop with itself"
                            );
                        rc = -2;
                    }
                    else
                    { // no desktop found
                        if (
                            (groups[2].Value.ToUpper() == "LAST")
                            || (groups[2].Value.ToUpper() == "*LAST*")
                        )
                        { // last desktop
                            iParam = VirtualDesktop.Desktop.Count - 1;
                            if (rc == iParam)
                            {
                                if (verbose)
                                    Console.WriteLine(
                                        "Cannot swap virtual desktop with itself"
                                    );
                                rc = -2;
                            }
                            else
                            {
                                if (verbose)
                                    Console.WriteLine(
                                        "Swapping virtual desktops number "
                                            + rc.ToString()
                                            + " (desktop '"
                                            + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                                rc
                                            )
                                            + "') and number "
                                            + iParam.ToString()
                                            + " (desktop '"
                                            + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                                iParam
                                            )
                                            + "')"
                                    );
                                try
                                { // swap virtual desktops rc and iParam
                                    SwapDesktops(rc, iParam);
                                    rc = iParam;
                                }
                                catch
                                { // error while swapping
                                    rc = -1;
                                }
                            }
                        }
                        else
                        { // no desktop found
                            if (verbose)
                                Console.WriteLine(
                                    "Could not find virtual desktop with name containing '"
                                        + groups[2].Value
                                        + "'"
                                );
                            rc = -2;
                        }
                    }
                }
            }
            break;

        case "INSERTDESKTOP": // insert desktop
        case "ID":
            if (int.TryParse(groups[2].Value, out iParam))
            { // parameter is an integer, use as desktop number
                if (
                    (iParam >= 0)
                    && (iParam < VirtualDesktop.Desktop.Count)
                    && (rc != iParam)
                )
                { // check if parameter is in range of active desktops
                    if (verbose)
                        Console.WriteLine(
                            "Inserting virtual desktop number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "') before desktop number "
                                + rc.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    rc
                                )
                                + "') or vice versa"
                        );
                    try
                    { // insert virtual desktop iParam before rc
                        InsertDesktop(rc, iParam);
                        rc = iParam;
                    }
                    catch
                    { // error while inserting
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            { // parameter is a string, search as part of desktop name
                iParam = VirtualDesktop.Desktop.SearchDesktop(groups[2].Value);
                if ((iParam >= 0) && (rc != iParam))
                { // desktop found
                    if (verbose)
                        Console.WriteLine(
                            "Inserting virtual desktop number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "') before desktop number "
                                + rc.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    rc
                                )
                                + "') or vice versa"
                        );
                    try
                    { // insert virtual desktop iParam before rc
                        InsertDesktop(rc, iParam);
                        rc = iParam;
                    }
                    catch
                    { // error while inserting
                        rc = -1;
                    }
                }
                else
                { // no desktop found or source and target the same
                    if (rc == iParam)
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Cannot insert virtual desktop before itself"
                            );
                        rc = -2;
                    }
                    else
                    { // no desktop found
                        if (
                            (groups[2].Value.ToUpper() == "LAST")
                            || (groups[2].Value.ToUpper() == "*LAST*")
                        )
                        { // last desktop
                            iParam = VirtualDesktop.Desktop.Count - 1;
                            if (rc == iParam)
                            {
                                if (verbose)
                                    Console.WriteLine(
                                        "Cannot insert virtual desktop before itself"
                                    );
                                rc = -2;
                            }
                            else
                            {
                                if (verbose)
                                    Console.WriteLine(
                                        "Inserting virtual desktop number "
                                            + iParam.ToString()
                                            + " (desktop '"
                                            + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                                iParam
                                            )
                                            + "') before desktop number "
                                            + rc.ToString()
                                            + " (desktop '"
                                            + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                                rc
                                            )
                                            + "') or vice versa"
                                    );
                                try
                                { // insert virtual desktop iParam before rc
                                    InsertDesktop(rc, iParam);
                                    rc = iParam;
                                }
                                catch
                                { // error while inserting
                                    rc = -1;
                                }
                            }
                        }
                        else
                        { // no desktop found
                            if (verbose)
                                Console.WriteLine(
                                    "Could not find virtual desktop with name containing '"
                                        + groups[2].Value
                                        + "'"
                                );
                            rc = -2;
                        }
                    }
                }
            }
            break;

        case "MoveWindowsToDesktop": // move windows of desktop in pipeline to desktop
        case "MWTD":
            if (int.TryParse(groups[2].Value, out iParam))
            { // parameter is an integer, use as desktop number
                if (
                    (iParam >= 0)
                    && (iParam < VirtualDesktop.Desktop.Count)
                    && (rc != iParam)
                )
                { // check if parameter is in range of active desktops
                    if (verbose)
                        Console.WriteLine(
                            "Moving windows on virtual desktop number "
                                + rc.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    rc
                                )
                                + "') to desktop number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "')"
                        );
                    try
                    { // move windows on desktop rc to desktop iParam
                        MoveWindowsToDesktop(rc, iParam);
                        rc = iParam;
                    }
                    catch
                    { // error while moving
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            { // parameter is a string, search as part of desktop name
                iParam = VirtualDesktop.Desktop.SearchDesktop(groups[2].Value);
                if ((iParam >= 0) && (rc != iParam))
                { // desktop found
                    if (verbose)
                        Console.WriteLine(
                            "Moving windows on virtual desktop number "
                                + rc.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    rc
                                )
                                + "') to desktop number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "')"
                        );
                    try
                    { // move windows on desktop rc to desktop iParam
                        MoveWindowsToDesktop(rc, iParam);
                        rc = iParam;
                    }
                    catch
                    { // error while moving
                        rc = -1;
                    }
                }
                else
                { // no desktop found or source and target the same
                    if (rc == iParam)
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Cannot move to same virtual desktop"
                            );
                        rc = -2;
                    }
                    else
                    { // no desktop found
                        if (
                            (groups[2].Value.ToUpper() == "LAST")
                            || (groups[2].Value.ToUpper() == "*LAST*")
                        )
                        { // last desktop
                            iParam = VirtualDesktop.Desktop.Count - 1;
                            if (rc == iParam)
                            {
                                if (verbose)
                                    Console.WriteLine(
                                        "Cannot move to same virtual desktop"
                                    );
                                rc = -2;
                            }
                            else
                            {
                                if (verbose)
                                    Console.WriteLine(
                                        "Moving windows on virtual desktop number "
                                            + rc.ToString()
                                            + " (desktop '"
                                            + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                                rc
                                            )
                                            + "') to desktop number "
                                            + iParam.ToString()
                                            + " (desktop '"
                                            + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                                iParam
                                            )
                                            + "')"
                                    );
                                try
                                { // move windows on desktop rc to desktop iParam
                                    MoveWindowsToDesktop(rc, iParam);
                                    rc = iParam;
                                }
                                catch
                                { // error while moving
                                    rc = -1;
                                }
                            }
                        }
                        else
                        { // no desktop found
                            if (verbose)
                                Console.WriteLine(
                                    "Could not find virtual desktop with name containing '"
                                        + groups[2].Value
                                        + "'"
                                );
                            rc = -2;
                        }
                    }
                }
            }
            break;

        case "LISTWINDOWSONDESKTOP": // list window handles of windows shown on desktop
        case "LWOD":
                if (int.TryParse(groups[2].Value, out iParam))
            { // parameter is an integer, use as desktop number
                if ((iParam >= 0) && (iParam < VirtualDesktop.Desktop.Count))
                { // check if parameter is in range of active desktops
                    if (verbose)
                        Console.WriteLine(
                            "Listing handles of windows on virtual desktop number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "')"
                        );
                    try
                    { // list window handles on desktop iParam
                        ListWindowsOnDesktop(iParam);
                        rc = iParam;
                    }
                    catch
                    { // error while listing
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            { // parameter is a string, search as part of desktop name
                iParam = VirtualDesktop.Desktop.SearchDesktop(groups[2].Value);
                if (iParam >= 0)
                { // desktop found
                    if (verbose)
                        Console.WriteLine(
                            "Listing window handles of windows on virtual desktop number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "')"
                        );
                    try
                    { // list window handles on desktop iParam
                        ListWindowsOnDesktop(iParam);
                        rc = iParam;
                    }
                    catch
                    { // error while listing
                        rc = -1;
                    }
                }
                else
                { // no desktop found
                    if (
                        (groups[2].Value.ToUpper() == "LAST")
                        || (groups[2].Value.ToUpper() == "*LAST*")
                    )
                    { // last desktop
                        iParam = VirtualDesktop.Desktop.Count - 1;
                        if (verbose)
                            Console.WriteLine(
                                "Listing window handles of windows on virtual desktop number "
                                    + iParam.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        iParam
                                    )
                                    + "')"
                            );
                        try
                        { // list window handles on desktop iParam
                            ListWindowsOnDesktop(iParam);
                            rc = iParam;
                        }
                        catch
                        { // error while listing
                            rc = -1;
                        }
                    }
                    else
                    { // no desktop found
                        if (verbose)
                            Console.WriteLine(
                                "Could not find virtual desktop with name containing '"
                                    + groups[2].Value
                                    + "'"
                            );
                        rc = -2;
                    }
                }
            }
            break;


        case "LWCOD":
            if (int.TryParse(groups[2].Value, out iParam))
            { // parameter is an integer, use as desktop number
                if ((iParam >= 0) && (iParam < VirtualDesktop.Desktop.Count))
                { // check if parameter is in range of active desktops
                    if (verbose)
                        Console.WriteLine(
                            "Listing handles of windows on virtual desktop number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "')"
                        );
                    try
                    { // list window handles on desktop iParam
                        ListWindowClassesOnDesktop(iParam);
                        rc = iParam;
                    }
                    catch
                    { // error while listing
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            { // parameter is a string, search as part of desktop name
                iParam = VirtualDesktop.Desktop.SearchDesktop(groups[2].Value);
                if (iParam >= 0)
                { // desktop found
                    if (verbose)
                        Console.WriteLine(
                            "Listing window handles of windows on virtual desktop number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "')"
                        );
                    try
                    { // list window handles on desktop iParam
                        ListWindowClassesOnDesktop(iParam);
                        rc = iParam;
                    }
                    catch
                    { // error while listing
                        rc = -1;
                    }
                }
                else
                { // no desktop found
                    if (
                        (groups[2].Value.ToUpper() == "LAST")
                        || (groups[2].Value.ToUpper() == "*LAST*")
                    )
                    { // last desktop
                        iParam = VirtualDesktop.Desktop.Count - 1;
                        if (verbose)
                            Console.WriteLine(
                                "Listing window handles of windows on virtual desktop number "
                                    + iParam.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        iParam
                                    )
                                    + "')"
                            );
                        try
                        { // list window handles on desktop iParam
                            ListWindowClassesOnDesktop(iParam);
                            rc = iParam;
                        }
                        catch
                        { // error while listing
                            rc = -1;
                        }
                    }
                    else
                    { // no desktop found
                        if (verbose)
                            Console.WriteLine(
                                "Could not find virtual desktop with name containing '"
                                    + groups[2].Value
                                    + "'"
                            );
                        rc = -2;
                    }
                }
            }
            break;
        case "CLOSEWINDOWSONDESKTOP": // close windows shown on desktop
        case "CWOD":
            if (int.TryParse(groups[2].Value, out iParam))
            { // parameter is an integer, use as desktop number
                if ((iParam >= 0) && (iParam < VirtualDesktop.Desktop.Count))
                { // check if parameter is in range of active desktops
                    if (verbose)
                        Console.WriteLine(
                            "Closing windows on virtual desktop number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "')"
                        );
                    try
                    { // close windows on desktop iParam
                        CloseWindowsOnDesktop(iParam);
                        rc = iParam;
                    }
                    catch
                    { // error while closing
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            { // parameter is a string, search as part of desktop name
                iParam = VirtualDesktop.Desktop.SearchDesktop(groups[2].Value);
                if (iParam >= 0)
                { // desktop found
                    if (verbose)
                        Console.WriteLine(
                            "Closing windows on virtual desktop number "
                                + iParam.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    iParam
                                )
                                + "')"
                        );
                    try
                    { // close windows on desktop iParam
                        CloseWindowsOnDesktop(iParam);
                        rc = iParam;
                    }
                    catch
                    { // error while closing
                        rc = -1;
                    }
                }
                else
                { // no desktop found
                    if (
                        (groups[2].Value.ToUpper() == "LAST")
                        || (groups[2].Value.ToUpper() == "*LAST*")
                    )
                    { // last desktop
                        iParam = VirtualDesktop.Desktop.Count - 1;
                        if (verbose)
                            Console.WriteLine(
                                "Closing windows on virtual desktop number "
                                    + iParam.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        iParam
                                    )
                                    + "')"
                            );
                        try
                        { // close windows on desktop iParam
                            CloseWindowsOnDesktop(iParam);
                            rc = iParam;
                        }
                        catch
                        { // error while closing
                            rc = -1;
                        }
                    }
                    else
                    { // no desktop found
                        if (verbose)
                            Console.WriteLine(
                                "Could not find virtual desktop with name containing '"
                                    + groups[2].Value
                                    + "'"
                            );
                        rc = -2;
                    }
                }
            }
            break;

        case "GETDESKTOPFROMWINDOW": // get desktop from window
        case "GDFW":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    { // seeking desktop for process handle
                        iParam = (int)
                            System.Diagnostics.Process
                                .GetProcessById(iParam)
                                .MainWindowHandle;
                        // process handle converted to window handle
                        rc = VirtualDesktop.Desktop.FromDesktop(
                            VirtualDesktop.Desktop.FromWindow((IntPtr)iParam)
                        );
                        if (verbose)
                            Console.WriteLine(
                                "Window is on desktop number "
                                    + rc.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        rc
                                    )
                                    + "')"
                            );
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to process id "
                                    + groups[2].Value
                                    + "' not found"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking desktop for process name
                    iParam = GetMainWindowHandle(groups[2].Value.Trim());
                    rc = VirtualDesktop.Desktop.FromDesktop(
                        VirtualDesktop.Desktop.FromWindow((IntPtr)iParam)
                    );
                    if (verbose)
                        Console.WriteLine(
                            "Window of process '"
                                + groups[2].Value
                                + "' is on desktop number "
                                + rc.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    rc
                                )
                                + "')"
                        );
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Process '" + groups[2].Value + "' not found"
                        );
                    rc = -1;
                }
            }
            break;

        case "GETDESKTOPFROMWINDOWHANDLE": // get desktop from window handle
        case "GDFWH":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    { // seeking desktop for window handle
                        rc = VirtualDesktop.Desktop.FromDesktop(
                            VirtualDesktop.Desktop.FromWindow((IntPtr)iParam)
                        );
                        if (verbose)
                            Console.WriteLine(
                                "Window is on desktop number "
                                    + rc.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        rc
                                    )
                                    + "')"
                            );
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to handle "
                                    + groups[2].Value
                                    + "' not found"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking window with window title
                    iParam = (Int32)GetWindowFromTitle(
                        groups[2].Value.Trim().Replace("^", "")
                    );
                    // seeking desktop for window handle
                    rc = VirtualDesktop.Desktop.FromDesktop(
                        VirtualDesktop.Desktop.FromWindow((IntPtr)iParam)
                    );
                    if (verbose)
                        Console.WriteLine(
                            "Window '"
                                + foundTitle
                                + "' is on desktop number "
                                + rc.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    rc
                                )
                                + "')"
                        );
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Window with text '"
                                + groups[2].Value
                                + "' in title not found"
                        );
                    rc = -1;
                }
            }
            break;

        case "ISWINDOWONDESKTOP": // is window on desktop in rc
        case "IWOD":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    { // checking desktop for process handle
                        iParam = (int)
                            System.Diagnostics.Process
                                .GetProcessById(iParam)
                                .MainWindowHandle;
                        // process handle converted to window handle
                        if (
                            VirtualDesktop.Desktop
                                .FromIndex(rc)
                                .HasWindow((IntPtr)iParam)
                        )
                        {
                            if (verbose)
                                Console.WriteLine(
                                    "Window to process id "
                                        + groups[2].Value
                                        + " is on desktop number "
                                        + rc.ToString()
                                        + " (desktop '"
                                        + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                            rc
                                        )
                                        + "')"
                                );
                            rc = 0;
                        }
                        else
                        {
                            if (verbose)
                                Console.WriteLine(
                                    "Window to process id "
                                        + groups[2].Value
                                        + " is not on desktop number "
                                        + rc.ToString()
                                        + " (desktop '"
                                        + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                            rc
                                        )
                                        + "')"
                                );
                            rc = 1;
                        }
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to process id "
                                    + groups[2].Value
                                    + " not found"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking desktop for process name
                    iParam = GetMainWindowHandle(groups[2].Value.Trim());
                    if (
                        VirtualDesktop.Desktop
                            .FromIndex(rc)
                            .HasWindow((IntPtr)iParam)
                    )
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Window of process '"
                                    + groups[2].Value
                                    + "' is on desktop number "
                                    + rc.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        rc
                                    )
                                    + "')"
                            );
                        rc = 0;
                    }
                    else
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Window of process '"
                                    + groups[2].Value
                                    + "' is not on desktop number "
                                    + rc.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        rc
                                    )
                                    + "')"
                            );
                        rc = 1;
                    }
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Process '" + groups[2].Value + "' not found"
                        );
                    rc = -1;
                }
            }
            break;

        case "ISWINDOWHANDLEONDESKTOP": // is window with handle on desktop in rc
        case "IWHOD":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    { // checking desktop for window handle
                        if (
                            VirtualDesktop.Desktop
                                .FromIndex(rc)
                                .HasWindow((IntPtr)iParam)
                        )
                        {
                            if (verbose)
                                Console.WriteLine(
                                    "Window to handle "
                                        + groups[2].Value
                                        + " is on desktop number "
                                        + rc.ToString()
                                        + " (desktop '"
                                        + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                            rc
                                        )
                                        + "')"
                                );
                            rc = 0;
                        }
                        else
                        {
                            if (verbose)
                                Console.WriteLine(
                                    "Window to handle "
                                        + groups[2].Value
                                        + " is not on desktop number "
                                        + rc.ToString()
                                        + " (desktop '"
                                        + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                            rc
                                        )
                                        + "')"
                                );
                            rc = 1;
                        }
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to handle "
                                    + groups[2].Value
                                    + " not found"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking window with window title
                    iParam = (Int32)GetWindowFromTitle(
                        groups[2].Value.Trim().Replace("^", "")
                    );
                    // checking desktop for window handle
                    if (
                        VirtualDesktop.Desktop
                            .FromIndex(rc)
                            .HasWindow((IntPtr)iParam)
                    )
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Window '"
                                    + foundTitle
                                    + "' is on desktop number "
                                    + rc.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        rc
                                    )
                                    + "')"
                            );
                        rc = 0;
                    }
                    else
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Window '"
                                    + foundTitle
                                    + "' is not on desktop number "
                                    + rc.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        rc
                                    )
                                    + "')"
                            );
                        rc = 1;
                    }
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Window with text '"
                                + groups[2].Value
                                + "' in title not found"
                        );
                    rc = -1;
                }
            }
            break;

        case "MOVEWINDOW": // move window to desktop in rc
        case "MW":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    { // seeking window for process handle
                        iParam = (int)
                            System.Diagnostics.Process
                                .GetProcessById(iParam)
                                .MainWindowHandle;
                        // process handle converted to window handle and move window
                        VirtualDesktop.Desktop
                            .FromIndex(rc)
                            .MoveWindow((IntPtr)iParam);
                        if (verbose)
                            Console.WriteLine(
                                "Window to process id "
                                    + groups[2].Value
                                    + " moved to desktop number "
                                    + rc.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        rc
                                    )
                                    + "')"
                            );
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to process id "
                                    + groups[2].Value
                                    + " not found or move failed"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking window for process name
                    iParam = GetMainWindowHandle(groups[2].Value.Trim());
                    // move window
                    VirtualDesktop.Desktop
                        .FromIndex(rc)
                        .MoveWindow((IntPtr)iParam);
                    if (verbose)
                        Console.WriteLine(
                            "Window of process '"
                                + groups[2].Value
                                + "' moved to desktop number "
                                + rc.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    rc
                                )
                                + "')"
                        );
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Process '"
                                + groups[2].Value
                                + "' not found or move failed"
                        );
                    rc = -1;
                }
            }
            break;

        case "MOVEWINDOWHANDLE": // move window with handle to desktop in rc
        case "MWH":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    {
                        // use window handle and move window
                        VirtualDesktop.Desktop
                            .FromIndex(rc)
                            .MoveWindow((IntPtr)iParam);
                        if (verbose)
                            Console.WriteLine(
                                "Window to handle "
                                    + groups[2].Value
                                    + " moved to desktop number "
                                    + rc.ToString()
                                    + " (desktop '"
                                    + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                        rc
                                    )
                                    + "')"
                            );
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to handle "
                                    + groups[2].Value
                                    + " not found or move failed"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking window with window title
                    iParam = (Int32)GetWindowFromTitle(
                        groups[2].Value.Trim().Replace("^", "")
                    );
                    // move window
                    VirtualDesktop.Desktop
                        .FromIndex(rc)
                        .MoveWindow((IntPtr)iParam);
                    if (verbose)
                        Console.WriteLine(
                            "Window '"
                                + foundTitle
                                + "' moved to desktop number "
                                + rc.ToString()
                                + " (desktop '"
                                + VirtualDesktop.Desktop.DesktopNameFromIndex(
                                    rc
                                )
                                + "')"
                        );
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Window with text '"
                                + groups[2].Value
                                + "' in title not found or move failed"
                        );
                    rc = -1;
                }
            }
            break;

        case "ISWINDOWPINNED": // is window pinned to all desktops
        case "IWP":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    { // checking desktop for process handle
                        iParam = (int)
                            System.Diagnostics.Process
                                .GetProcessById(iParam)
                                .MainWindowHandle;
                        // process handle converted to window handle
                        if (
                            VirtualDesktop.Desktop.IsWindowPinned(
                                (IntPtr)iParam
                            )
                        )
                        {
                            if (verbose)
                                Console.WriteLine(
                                    "Window to process id "
                                        + groups[2].Value
                                        + " is pinned to all desktops"
                                );
                            rc = 0;
                        }
                        else
                        {
                            if (verbose)
                                Console.WriteLine(
                                    "Window to process id "
                                        + groups[2].Value
                                        + " is not pinned to all desktops"
                                );
                            rc = 1;
                        }
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to process id "
                                    + groups[2].Value
                                    + " not found"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking desktop for process name
                    iParam = GetMainWindowHandle(groups[2].Value.Trim());
                    if (VirtualDesktop.Desktop.IsWindowPinned((IntPtr)iParam))
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Window of process '"
                                    + groups[2].Value
                                    + "' is pinned to all desktops"
                            );
                        rc = 0;
                    }
                    else
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Window of process '"
                                    + groups[2].Value
                                    + "' is not pinned to all desktops"
                            );
                        rc = 1;
                    }
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Process '" + groups[2].Value + "' not found"
                        );
                    rc = -1;
                }
            }
            break;

        case "ISWINDOWHANDLEPINNED": // is window with handle pinned to all desktops
        case "IWHP":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    { // checking desktop for window handle
                        if (VirtualDesktop.Desktop.IsWindowPinned((IntPtr)iParam))
                        {
                            if (verbose)
                                Console.WriteLine(
                                    "Window to handle "
                                        + groups[2].Value
                                        + " is pinned to all desktops"
                                );
                            rc = 0;
                        }
                        else
                        {
                            if (verbose)
                                Console.WriteLine(
                                    "Window to handle "
                                        + groups[2].Value
                                        + " is not pinned to all desktops"
                                );
                            rc = 1;
                        }
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to handle "
                                    + groups[2].Value
                                    + " not found"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking window with window title
                    iParam = (Int32)GetWindowFromTitle(
                        groups[2].Value.Trim().Replace("^", "")
                    );
                    if (VirtualDesktop.Desktop.IsWindowPinned((IntPtr)iParam))
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Window '"
                                    + foundTitle
                                    + "' is pinned to all desktops"
                            );
                        rc = 0;
                    }
                    else
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Window '"
                                    + foundTitle
                                    + "' is not pinned to all desktops"
                            );
                        rc = 1;
                    }
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Window with text '"
                                + groups[2].Value
                                + "' in title not found"
                        );
                    rc = -1;
                }
            }
            break;

        case "PINWINDOW": // pin window to all desktops
        case "PW":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    { // seeking window for process handle
                        iParam = (int)
                            System.Diagnostics.Process
                                .GetProcessById(iParam)
                                .MainWindowHandle;
                        // process handle converted to window handle and pin window
                        VirtualDesktop.Desktop.PinWindow((IntPtr)iParam);
                        if (verbose)
                            Console.WriteLine(
                                "Window to process id "
                                    + groups[2].Value
                                    + " pinned to all desktops"
                            );
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to process id "
                                    + groups[2].Value
                                    + " not found or pin failed"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking window for process name
                    iParam = GetMainWindowHandle(groups[2].Value.Trim());
                    // pin window
                    VirtualDesktop.Desktop.PinWindow((IntPtr)iParam);
                    if (verbose)
                        Console.WriteLine(
                            "Window of process '"
                                + groups[2].Value
                                + "' pinned to all desktops"
                        );
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Process '"
                                + groups[2].Value
                                + "' not found or pin failed"
                        );
                    rc = -1;
                }
            }
            break;

        case "PINWINDOWHANDLE": // pin window with handle to all desktops
        case "PWH":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    { // process window handle and pin window
                        VirtualDesktop.Desktop.PinWindow((IntPtr)iParam);
                        if (verbose)
                            Console.WriteLine(
                                "Window to handle "
                                    + groups[2].Value
                                    + " pinned to all desktops"
                            );
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to handle "
                                    + groups[2].Value
                                    + " not found or pin failed"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking window with window title
                    iParam = (Int32)GetWindowFromTitle(
                        groups[2].Value.Trim().Replace("^", "")
                    );
                    // pin window
                    VirtualDesktop.Desktop.PinWindow((IntPtr)iParam);
                    if (verbose)
                        Console.WriteLine(
                            "Window '" + foundTitle + "' pinned to all desktops"
                        );
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Window with text '"
                                + groups[2].Value
                                + "' in title not found or pin failed"
                        );
                    rc = -1;
                }
            }
            break;

        case "UNPINWINDOW": // unpin window from all desktops
        case "UPW":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    { // seeking window for process handle
                        iParam = (int)
                            System.Diagnostics.Process
                                .GetProcessById(iParam)
                                .MainWindowHandle;
                        // process handle converted to window handle and unpin window
                        VirtualDesktop.Desktop.UnpinWindow((IntPtr)iParam);
                        if (verbose)
                            Console.WriteLine(
                                "Window to process id "
                                    + groups[2].Value
                                    + " unpinned from all desktops"
                            );
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to process id "
                                    + groups[2].Value
                                    + " not found or unpin failed"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking window for process name
                    iParam = GetMainWindowHandle(groups[2].Value.Trim());
                    // unpin window
                    VirtualDesktop.Desktop.UnpinWindow((IntPtr)iParam);
                    if (verbose)
                        Console.WriteLine(
                            "Window of process '"
                                + groups[2].Value
                                + "' unpinned from all desktops"
                        );
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Process '"
                                + groups[2].Value
                                + "' not found or unpin failed"
                        );
                    rc = -1;
                }
            }
            break;

        case "UNPINWINDOWHANDLE": // unpin window with handle from all desktops
        case "UPWH":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    { // process window handle and unpin window
                        VirtualDesktop.Desktop.UnpinWindow((IntPtr)iParam);
                        if (verbose)
                            Console.WriteLine(
                                "Window to handle "
                                    + groups[2].Value
                                    + " unpinned from all desktops"
                            );
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to handle "
                                    + groups[2].Value
                                    + " not found or unpin failed"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking window with window title
                    iParam = (Int32)GetWindowFromTitle(
                        groups[2].Value.Trim().Replace("^", "")
                    );
                    // unpin window
                    VirtualDesktop.Desktop.UnpinWindow((IntPtr)iParam);
                    if (verbose)
                        Console.WriteLine(
                            "Window '"
                                + foundTitle
                                + "' unpinned from all desktops"
                        );
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Window with text '"
                                + groups[2].Value
                                + "' in title not found or unpin failed"
                        );
                    rc = -1;
                }
            }
            break;

        case "ISAPPLICATIONPINNED": // is application pinned to all desktops
        case "IAP":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    { // checking desktop for process handle
                        iParam = (int)
                            System.Diagnostics.Process
                                .GetProcessById(iParam)
                                .MainWindowHandle;
                        // process handle converted to window handle
                        if (
                            VirtualDesktop.Desktop.IsApplicationPinned(
                                (IntPtr)iParam
                            )
                        )
                        {
                            if (verbose)
                                Console.WriteLine(
                                    "Application to process id "
                                        + groups[2].Value
                                        + " is pinned to all desktops"
                                );
                            rc = 0;
                        }
                        else
                        {
                            if (verbose)
                                Console.WriteLine(
                                    "Application to process id "
                                        + groups[2].Value
                                        + " is not pinned to all desktops"
                                );
                            rc = 1;
                        }
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to process id "
                                    + groups[2].Value
                                    + " not found"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking desktop for process name
                    iParam = GetMainWindowHandle(groups[2].Value.Trim());
                    if (
                        VirtualDesktop.Desktop.IsApplicationPinned(
                            (IntPtr)iParam
                        )
                    )
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Application of process '"
                                    + groups[2].Value
                                    + "' is pinned to all desktops"
                            );
                        rc = 0;
                    }
                    else
                    {
                        if (verbose)
                            Console.WriteLine(
                                "Application of process '"
                                    + groups[2].Value
                                    + "' is not pinned to all desktops"
                            );
                        rc = 1;
                    }
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Process '" + groups[2].Value + "' not found"
                        );
                    rc = -1;
                }
            }
            break;

        case "PINAPPLICATION": // pin application to all desktops
        case "PA":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    { // seeking window for process handle
                        iParam = (int)
                            System.Diagnostics.Process
                                .GetProcessById(iParam)
                                .MainWindowHandle;
                        // process handle converted to window handle and pin window
                        VirtualDesktop.Desktop.PinApplication((IntPtr)iParam);
                        if (verbose)
                            Console.WriteLine(
                                "Application to process id "
                                    + groups[2].Value
                                    + " pinned to all desktops"
                            );
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to process id "
                                    + groups[2].Value
                                    + " not found or pin failed"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking window for process name
                    iParam = GetMainWindowHandle(groups[2].Value.Trim());
                    // pin window
                    VirtualDesktop.Desktop.PinApplication((IntPtr)iParam);
                    if (verbose)
                        Console.WriteLine(
                            "Application of process '"
                                + groups[2].Value
                                + "' pinned to all desktops"
                        );
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Process '"
                                + groups[2].Value
                                + "' not found or pin failed"
                        );
                    rc = -1;
                }
            }
            break;

        case "UNPINAPPLICATION": // unpin application from all desktops
        case "UPA":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    try
                    { // seeking window for process handle
                        iParam = (int)
                            System.Diagnostics.Process
                                .GetProcessById(iParam)
                                .MainWindowHandle;
                        // process handle converted to window handle and unpin window
                        VirtualDesktop.Desktop.UnpinApplication((IntPtr)iParam);
                        if (verbose)
                            Console.WriteLine(
                                "Application to process id "
                                    + groups[2].Value
                                    + " unpinned from all desktops"
                            );
                    }
                    catch
                    { // error while seeking
                        if (verbose)
                            Console.WriteLine(
                                "Window to process id "
                                    + groups[2].Value
                                    + " not found or unpin failed"
                            );
                        rc = -1;
                    }
                }
                else
                    rc = -1;
            }
            else
            {
                try
                { // seeking window for process name
                    iParam = GetMainWindowHandle(groups[2].Value.Trim());
                    // unpin window
                    VirtualDesktop.Desktop.UnpinApplication((IntPtr)iParam);
                    if (verbose)
                        Console.WriteLine(
                            "Application of process '"
                                + groups[2].Value
                                + "' unpinned from all desktops"
                        );
                }
                catch
                { // error while seeking
                    if (verbose)
                        Console.WriteLine(
                            "Process '"
                                + groups[2].Value
                                + "' not found or unpin failed"
                        );
                    rc = -1;
                }
            }
            break;

        case "CALCULATE": //calculate
        case "CALC":
        case "CA":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (verbose)
                    Console.WriteLine(
                        "Adding " + iParam.ToString() + " to last result."
                    );
                // adding iParam to result
                rc += iParam;
            }
            else
                rc = -2;
            break;

        case "SLEEP": //wait
        case "SL":
            if (int.TryParse(groups[2].Value, out iParam))
            { // check if parameter is an integer
                if (iParam > 0)
                { // check if parameter is greater than 0
                    if (verbose)
                        Console.WriteLine(
                            "Waiting " + iParam.ToString() + "ms"
                        );
                    // waiting iParam milliseconds
                    System.Threading.Thread.Sleep(iParam);
                }
                else
                    rc = -1;
            }
            else
                rc = -2;
            break;

        default:
            rc = -2;
            break;
    }
}